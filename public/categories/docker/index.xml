<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Docker on My New Hugo Site</title>
    <link>http://localhost:1313/categories/docker/</link>
    <description>Recent content in Docker on My New Hugo Site</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Thu, 02 Aug 2018 23:27:27 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/categories/docker/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>docker runで上げたコンテナに docker-compose upで上げたコンテナをlinkする</title>
      <link>http://localhost:1313/posts/post-566/</link>
      <pubDate>Thu, 02 Aug 2018 23:27:27 +0000</pubDate>
      <guid>http://localhost:1313/posts/post-566/</guid>
      <description>&lt;h2 id=&#34;なんでそんなことしたかったの&#34;&gt;なんでそんなことしたかったの&lt;/h2&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;もともとコンテナをitamaeスクリプトでdocker runして立ち上げていた&#xA;&lt;ul&gt;&#xA;&lt;li&gt;オプションが増えてきてコマンドが非常に長くなった&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;何を書いているのかわかりにくかったのでdocker-compose.ymlにオプションを書いて起動することに&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;現状&#34;&gt;現状&lt;/h2&gt;&#xA;&lt;p&gt;すでに上がっているコンテナ&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;mariadb&#xA;&lt;ul&gt;&#xA;&lt;li&gt;mysql互換なので&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;redis&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ログ&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;table&gt;&#xA;  &lt;thead&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;th&gt;CONTAINER ID&lt;/th&gt;&#xA;          &lt;th&gt;IMAGE&lt;/th&gt;&#xA;          &lt;th&gt;COMMAND&lt;/th&gt;&#xA;          &lt;th&gt;CREATED&lt;/th&gt;&#xA;          &lt;th&gt;STATUS&lt;/th&gt;&#xA;          &lt;th&gt;PORTS&lt;/th&gt;&#xA;          &lt;th&gt;NAMES&lt;/th&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/thead&gt;&#xA;  &lt;tbody&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;acb7e507f8e2&lt;/td&gt;&#xA;          &lt;td&gt;mariadb&lt;/td&gt;&#xA;          &lt;td&gt;&amp;ldquo;docker-entrypoint.s…&amp;rdquo;&lt;/td&gt;&#xA;          &lt;td&gt;8 days ago&lt;/td&gt;&#xA;          &lt;td&gt;Up 8 days&lt;/td&gt;&#xA;          &lt;td&gt;0.0.0.0:3306-&amp;gt;3306/tcp&lt;/td&gt;&#xA;          &lt;td&gt;mariadb_1&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;a3240056a0a3&lt;/td&gt;&#xA;          &lt;td&gt;redis:4.0.8&lt;/td&gt;&#xA;          &lt;td&gt;&amp;ldquo;docker-entrypoint.s…&amp;rdquo;&lt;/td&gt;&#xA;          &lt;td&gt;8 days ago&lt;/td&gt;&#xA;          &lt;td&gt;Up 8 days&lt;/td&gt;&#xA;          &lt;td&gt;0.0.0.0:6379-&amp;gt;6379/tcp&lt;/td&gt;&#xA;          &lt;td&gt;redis_1&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;docker-compose upで上げるコンテナ&lt;/td&gt;&#xA;          &lt;td&gt;&lt;/td&gt;&#xA;          &lt;td&gt;&lt;/td&gt;&#xA;          &lt;td&gt;&lt;/td&gt;&#xA;          &lt;td&gt;&lt;/td&gt;&#xA;          &lt;td&gt;&lt;/td&gt;&#xA;          &lt;td&gt;&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/tbody&gt;&#xA;&lt;/table&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;javaアプリ&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Spring BootでDBにつないでる&lt;/li&gt;&#xA;&lt;li&gt;commandオプションにて起動&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;docker-runのとき&#34;&gt;docker runのとき&lt;/h2&gt;&#xA;&lt;pre&gt;&lt;code&gt;execute &amp;quot;docker build . -t #{NAME}&amp;quot; do&#xA;  user &#39;root&#39;&#xA;  cwd ROOM_HOME&#xA;end&#xA;&#xA;execute &amp;quot;sudo docker run -d -p 8080:8080 -e TZ=Asia/Tokyo --name #{NAME} --net team_default --link mariadb_1:mysql --link redis_1:redis -v /var/log/app/:/var/log/app/ -v /home/team/app_build/:/home -it #{NAME} java -jar -Dspring.config.location=\&amp;quot;/home/application.yml\&amp;quot; app.jar&amp;quot; do&#xA;  user &#39;root&#39;&#xA;  cwd &#39;/home/team&#39;&#xA;end&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 id=&#34;docker-compose-up&#34;&gt;docker-compose up&lt;/h2&gt;&#xA;&lt;p&gt;上をdocker-compose upにする&lt;/p&gt;</description>
    </item>
    <item>
      <title>Dockerで作成したイメージのリポジトリ名とタグ名を変更する</title>
      <link>http://localhost:1313/posts/docker-rename-repo-tag/</link>
      <pubDate>Tue, 18 Apr 2017 19:04:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/docker-rename-repo-tag/</guid>
      <description>&lt;p&gt;Dockerで作成したコンテナイメージをDockerHubにプッシュしようとしたら下記エラーが出てできなかった．&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$ docker images&#xA;REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE&#xA;hoge/httpd     ver1.0              54e9a8d65f50        2 days ago          258 MB&#xA;$ docker push hoge/httpd:ver1.0&#xA;The push refers to a repository [docker.io/hoge/httpd]&#xA;09ce67b5172f: Preparing&#xA;5f70bf18a086: Preparing&#xA;8d12f3483b2e: Preparing&#xA;denied: requested access to the resource is denied&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;どうやらローカルのリポジトリ名とDockerHubのリポジトリ名が一致していないよって言われてるみたい．  &lt;a href=&#34;http://stackoverflow.com/questions/41984399/denied-requested-access-to-the-resource-is-denied-docker&#34;&gt;stackoverflow.com&lt;/a&gt; 自分のDockerHubのユーザー名がfugaだったのでそちらに変更．&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$ docker tag 54e9a8d65f50 fuga/httpd:ver1&#xA;$ docker images&#xA;REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE&#xA;fuga/httpd     ver1.0              54e9a8d65f50        2 days ago          258 MB&#xA;hoge/httpd     ver1.0              54e9a8d65f50        2 days ago          258 MB&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;そしていらなくなったイメージを削除．&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
